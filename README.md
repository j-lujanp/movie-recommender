# movie-recommender
Movie Recommender is a simple web application that presents a list of top rated movies to the user. The user has the capability to get lists of movies based on the available genres.
Movie Recommender is based on [Django Framework](https://www.djangoproject.com/), which means it follows a MVT pattern.
For the HTML representation, [Bootstrap](https://getbootstrap.com/) framework is used with CDN links.
An API has been added to allow users CRUD methods for the models of the application. For this, the [Django REST Framework](https://www.django-rest-framework.org/) has been used, including django-filter.
## Model design
The application has two main models (besides the ones generated by Django itself): Rater and Rating
### Rater
The rater model represent a movie service which actually rates the movies (more about this, later).
The only field that ths model includes is the name of the movie service.
### Rating
The rating model represent a rating for a movie. This model contains the following fields:
* Movie: the __title__ of the movie represented as a String
* Genre: the __genre or genres__ of the movie represented as a String
* Rating: the __rating__ of this movie for the particular Rater as a Integer
* Rater: the __rater__ which actually rated the movie as a Foreign Key to the Rater model
### Considerations about the models
In order to simplify the application we have encapsulated all the information of the rating in just one model instead os separating the Movies and Genres in other models. But this has a design reason behind. As different movie services may not write the title of a movie in the same manner or may consider a movie from a different set of genres, we may find inconsistences. As an evolution, in a new version the movie services' services should perform checks and aggregations that are beyond this simple application.
## Movie services
The different __movie services__ used by the application are based on an abstract class which defines a method named __update_ratings__ that must be implemented. This method is the one that communicates with the movie service API in order to fetch the top rated movies so the information in the local database is updated. The class that represent the movie service must be named exactly as the __Rater__ that represents.
When a user makes a request to get a list of the movies, the application get a list of all the raters in the application and executes the __update_ratings__ method in them. If there is a Rater which does not have a class implemented (or the class has not the exact same name as the Rater), the rater is ignored.
The movie services are called in each request from a user, which is useful for testing purposes but should be decoupled in a new version so the call for the movie services is done in the background by a daemon, management app or so.
For testing purposes two movie services has been implemented:
### Netflix
This movie service reads a JSON formatted file and store the results in the Rating model table.
### LocalDB
This movie service reads the ratings stored in a local model called LocalDB and stores the results in the Rating model table.
## Authentication
The access to the web (and the API) requires basic user authentication based on __username__ and __password__. There is a default admin user created with username: _admin_ and password: _12345_ which can be used for testing purposes.
In order to simplify, the admin login page has been used for login purposes. It can be accesed at [http://localhost:8000/admin/login/](http://localhost:8000/admin/login/)
## User interface
### Admin site
Django implements an admin web application that can be accesed in order to create new users, groups of users and also to modify the models of the recommender application.
This admin site is accesible by default at: [http://localhost:8000/admin/](http://localhost:8000/admin/)
### Recommender user interface
The user interface is a simple interface which includes a left panel listing all the available genres (this list is automatically populated taking into account the values of the field __genre__ of the Ratings) and a table with the recommendations. Choosing a Genre from the left panel will get you to a new page with the results filtered by that genre.
Again, this is really simple and just to show a minimal functionality, pagination anf filtering should also be included in a new version.
This recommender site is accesible by default at: [http://localhost:8000/recommender/](http://localhost:8000/recommender/)
If we know the name of a genre we want to filter by, we can directly access to [http://localhost:8000/recommender/genre/{Genre}](http://localhost:8000/recommender/genre/Drama) where the lookup for the genre is case insensitive.
## API
In parallel to the user interface an API to access the models Rater and Rating has been generated. This API allow the classical methods to CREATE, READ, UPDATE and DELETE records.
The base url (by default listening on port 8000) for the API is [http://localhost:8000/recommender/api/](http://localhost:8000/recommender/api/)
### Rater API
This API allow us to :
* get a list of all the raters of the application at [http://localhost:8000/recommender/api/raters/](http://localhost:8000/recommender/api/raters/)
* perform a GET, PUT, PATCH or DELETE on a specific rater at [http://localhost:8000/recommender/api/raters/{rater_id}](http://localhost:8000/recommender/api/raters/1)
### Rating API
This API allow us to :
* get a list of all the ratings of the application at [http://localhost:8000/recommender/api/ratings/](http://localhost:8000/recommender/api/ratings/) with a pagination of 10 elements per view. We can add the parameter _page={page_number}_ to the url to navigate to a specific page (for example: [http://localhost:8000/recommender/api/ratings/?page=1](http://localhost:8000/recommender/api/ratings/?page=1))
* perform a GET, PUT, PATCH or DELETE on a specific rating at [http://localhost:8000/recommender/api/ratings/{rating_id}](http://localhost:8000/recommender/api/ratings/58)
#### Filtering
The Rating API allow us to filter by genre and rater:
* To filter the resuls by an specific genre we can add the parameter _genre_ to the url. The API will lookup for ratings of movies which genre description includes the genre (case insensitive)
* To filter the results by an specific movie service we can add the parameter _rater_ to the url. The API will lookup for ratings of movies rated by the specific movie service provided (case insensitive)
All the filters may be combined along with pagination such in [http://localhost:8000/recommender/api/ratings/?page=1&genre=action&rater=netflix](http://localhost:8000/recommender/api/ratings/?page=1&genre=action&rater=netflix)
## Installation
### Manual installation
The application has been tested on Python 3.8.9, Django 3.2.7 and Django REST Framework 3.12.4 with the django-filters module.
Considering Python is already installed and a virtual environment is created (out of the scope of this README file):
* Installing Django
```
$ python -m pip install Django
```
* Installing Django REST Framework and django-filters
```
$ python -m pip install djangorestframework
$ python -m pip install django-filter
```
Then, clone the repository and navigate to the folder __project__ of the project to execute:
```
$  python manage.py runserver
```
And you should see something similar to:
```
Watching for file changes with StatReloader
Performing system checks...

System check identified no issues (0 silenced).
September 12, 2021 - 11:36:04
Django version 3.2.7, using settings 'project.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
```
Now you should be able to access at [http://localhost:8000/recommender](http://localhost:8000/recommender)
#### Testing
Some automated tests have been written and can be executed with:
```
$  python manage.py test recommender
```
### Docker
The application is also available as a docker container. In order to deploy the docker, the docker engine needs to be installed.
An example of the installation and execution of the docker would be:
```
$ docker pull jlujanp/movie-recommender
```
Once the image has been pulled, it can be deployed using:
```
$ docker run -it -p 8000:8000 jlujanp/movie-recommender
```
And again, you should see something similar to:
```
Watching for file changes with StatReloader
Performing system checks...

System check identified no issues (0 silenced).
September 12, 2021 - 11:36:04
Django version 3.2.7, using settings 'project.settings'
Starting development server at http://0.0.0.0:8000/
Quit the server with CONTROL-C.
```
Now you should be able to access at [http://localhost:8000/recommender](http://localhost:8000/recommender)
